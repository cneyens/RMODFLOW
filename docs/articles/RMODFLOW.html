<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to RMODFLOW â€¢ RMODFLOW</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google analytics --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32706734-4', 'auto');
  ga('send', 'pageview');

</script>
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">RMODFLOW</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/RMODFLOW.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rogiersbart/RMODFLOW">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to RMODFLOW</h1>
                        <h4 class="author">Bart Rogiers</h4>
            
            <h4 class="date">2017-08-05</h4>
          </div>

    
    
<div class="contents">
<div id="example-files" class="section level1">
<h1 class="hasAnchor">
<a href="#example-files" class="anchor"></a>Example files</h1>
<p>RMODFLOW currently comes with several example MODFLOW models. The models can be listed with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(RMODFLOW)
<span class="kw"><a href="../reference/rmf_example_models.html">rmf_example_models</a></span>()</code></pre></div>
<pre><code>## [1] "example-model"          "rocky-mountain-arsenal"
## [3] "water-supply-problem"</code></pre>
<p>These are all derived from the ModelMuse examples <a href="https://water.usgs.gov/nrp/gwsoftware/ModelMuse/Help/example_model.htm">Example Model</a>, <a href="https://water.usgs.gov/nrp/gwsoftware/ModelMuse/Help/rocky_mountain_arsenal.htm">Rocky Mountain Arsenal</a> and <a href="https://water.usgs.gov/nrp/gwsoftware/ModelMuse/Help/index.html?water_supply_problem.htm">Water Supply Problem</a>. For a list of all example files, use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_example_files.html">rmf_example_files</a></span>()</code></pre></div>
<pre><code>##  [1] "example-model.bas"            "example-model.cbc"           
##  [3] "example-model.chd"            "example-model.dis"           
##  [5] "example-model.fdn"            "example-model.fhd"           
##  [7] "example-model.gpt"            "example-model.gsf"           
##  [9] "example-model.lpf"            "example-model.lst"           
## [11] "example-model.md"             "example-model.mlt"           
## [13] "example-model.nam"            "example-model.oc"            
## [15] "example-model.pcg"            "example-model.pval"          
## [17] "example-model.Rmd"            "example-model.wel"           
## [19] "example-model.zon"            "rocky-mountain-arsenal.bas"  
## [21] "rocky-mountain-arsenal.cbc"   "rocky-mountain-arsenal.chd"  
## [23] "rocky-mountain-arsenal.dis"   "rocky-mountain-arsenal.fdn"  
## [25] "rocky-mountain-arsenal.fhd"   "rocky-mountain-arsenal.ftl"  
## [27] "rocky-mountain-arsenal.gpt"   "rocky-mountain-arsenal.gsf"  
## [29] "rocky-mountain-arsenal.lmt"   "rocky-mountain-arsenal.lpf"  
## [31] "rocky-mountain-arsenal.lst"   "rocky-mountain-arsenal.md"   
## [33] "rocky-mountain-arsenal.nam"   "rocky-mountain-arsenal.oc"   
## [35] "rocky-mountain-arsenal.pcg"   "rocky-mountain-arsenal.Rmd"  
## [37] "rocky-mountain-arsenal.wel"   "water-supply-problem.bas"    
## [39] "water-supply-problem.cbc"     "water-supply-problem.dis"    
## [41] "water-supply-problem.fdn"     "water-supply-problem.fhd"    
## [43] "water-supply-problem.gpt"     "water-supply-problem.gsf"    
## [45] "water-supply-problem.hob_out" "water-supply-problem.lpf"    
## [47] "water-supply-problem.lst"     "water-supply-problem.md"     
## [49] "water-supply-problem.nam"     "water-supply-problem.ob_hob" 
## [51] "water-supply-problem.oc"      "water-supply-problem.pcg"    
## [53] "water-supply-problem.riv"     "water-supply-problem.Rmd"    
## [55] "water-supply-problem.wel"</code></pre>
<p>The corresponding full file paths can be accessed through <code><a href="../reference/rmf_example_file.html">rmf_example_file()</a></code> as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span>(<span class="st">"example-model.dis"</span>)</code></pre></div>
<pre><code>## [1] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.dis"</code></pre>
<p>For all files from a single model, use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_example_model.html">rmf_example_model</a></span>(<span class="st">"example-model"</span>)</code></pre></div>
<pre><code>##  [1] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.bas" 
##  [2] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.cbc" 
##  [3] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.chd" 
##  [4] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.dis" 
##  [5] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.fdn" 
##  [6] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.fhd" 
##  [7] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.gpt" 
##  [8] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.gsf" 
##  [9] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.lpf" 
## [10] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.lst" 
## [11] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.md"  
## [12] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.mlt" 
## [13] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.nam" 
## [14] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.oc"  
## [15] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.pcg" 
## [16] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.pval"
## [17] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.Rmd" 
## [18] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.wel" 
## [19] "C:/Users/brogiers/Documents/R/R-3.4.1/library/RMODFLOW/extdata/example-model.zon"</code></pre>
</div>
<div id="io" class="section level1">
<h1 class="hasAnchor">
<a href="#io" class="anchor"></a>I/O</h1>
<p>All functions for reading MODFLOW files into R have a prefix <code>rmf_read_</code>, after which in most cases the most common file extension follows. You can for instance read in the discretization file <code>example-model.dis</code> using:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dis &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rmf_read_dis.html">rmf_read_dis</a></span>(<span class="kw"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span>(<span class="st">"example-model.dis"</span>))
<span class="kw">class</span>(dis)</code></pre></div>
<pre><code>## [1] "dis"         "rmf_package"</code></pre>
<p>For several MODFLOW file types, the functions need more than just the filename to be able to process the file. For reading in the basic package file, you for instance have to specify a dis object as an additional argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bas &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rmf_read_bas.html">rmf_read_bas</a></span>(<span class="kw"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span>(<span class="st">"example-model.bas"</span>), <span class="dt">dis =</span> dis)
<span class="kw">class</span>(bas)</code></pre></div>
<pre><code>## [1] "bas"         "rmf_package"</code></pre>
<p>For the heads outputted by the model, you also need to specify a bas object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hed &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rmf_read_hed.html">rmf_read_fhd</a></span>(<span class="kw"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span>(<span class="st">"example-model.fhd"</span>), <span class="dt">dis =</span> dis, <span class="dt">bas =</span> bas)
<span class="kw">class</span>(hed)</code></pre></div>
<pre><code>## [1] "hed"          "rmf_4d_array"</code></pre>
<p>To inspect the contents of these objects, which are often just lists, using <code>str()</code> is often useful:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(dis)</code></pre></div>
<pre><code>## List of 15
##  $ nlay  : num 9
##  $ nrow  : num 10
##  $ ncol  : num 10
##  $ nper  : num 1
##  $ itmuni: num 1
##  $ lenuni: num 2
##  $ laycbd: num [1:9] 0 0 0 0 0 0 0 0 0
##  $ delr  : rmf_1d_array [1:10(1d)] 100 100 100 100 100 100 100 100 100 100
##  $ delc  : rmf_1d_array [1:10(1d)] 100 100 100 100 100 100 100 100 100 100
##  $ top   : rmf_2d_array [1:10, 1:10] 0.105 0.952 1.363 1.445 1.331 ...
##  $ botm  : rmf_3d_array [1:10, 1:10, 1:9] -5.11 -5.95 -6.36 -6.45 -6.33 ...
##  $ perlen: num 1
##  $ nstp  : num 1
##  $ tsmult: num 1
##  $ sstr  : chr "SS"
##  - attr(*, "comment")= chr [1:6] " Discretization File created on 2017-05-30 by ModelMuse version 3.9.0.0." " Upper left corner: (0, 0)" " Lower left corner: (0, -1000)" " Upper right corner: (1000, 0)" ...
##  - attr(*, "class")= chr [1:2] "dis" "rmf_package"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(bas)</code></pre></div>
<pre><code>## List of 10
##  $ xsection    : logi FALSE
##  $ chtoch      : logi TRUE
##  $ free        : logi TRUE
##  $ printtime   : logi TRUE
##  $ showprogress: logi FALSE
##  $ stoperror   : logi FALSE
##  $ stoper      : num NA
##  $ ibound      : rmf_3d_array [1:10, 1:10, 1:9] 1 1 1 1 1 1 1 1 1 1 ...
##  $ hnoflo      : num -1e+20
##  $ strt        : rmf_3d_array [1:10, 1:10, 1:9] 30 30 30 30 30 30 30 30 30 30 ...
##  - attr(*, "comment")= chr " Basic Package file created on 2017-05-30 by ModelMuse version 3.9.0.0."
##  - attr(*, "class")= chr [1:2] "bas" "rmf_package"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(hed)</code></pre></div>
<pre><code>##  hed [1:10, 1:10, 1:9, 1] 30 29.9 29.9 29.9 29.9 ...
##  - attr(*, "kstp")= num 1
##  - attr(*, "kper")= num 1
##  - attr(*, "pertim")= num 1
##  - attr(*, "totim")= num 1
##  - attr(*, "desc")= chr "HEAD"
##  - attr(*, "ncol")= num 10
##  - attr(*, "nrow")= num 10
##  - attr(*, "ilay")= num 9</code></pre>
<p>All the elements in these lists are named following the MODFLOW variable names, as described in the <a href="https://water.usgs.gov/nrp/gwsoftware/modflow2000/MFDOC/">online guide to MODFLOW</a>, but we use lowercase throughout the package (except for the package title).</p>
<p>Similar to the reading functions, all writing functions start with a prefix <code>rmf_write_</code>, so you can try these as well. At this point, it might be useful to copy some of the example files to your working directory, and play around with them. You can use the following approach to do so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_copy_to_wd.html">rmf_copy_to_wd</a></span>(<span class="kw"><a href="../reference/rmf_example_model.html">rmf_example_model</a></span>(<span class="st">"example-model"</span>))</code></pre></div>
</div>
<div id="visualization" class="section level1">
<h1 class="hasAnchor">
<a href="#visualization" class="anchor"></a>Visualization</h1>
<p>Many ways of visualizing 2D, 3D and 4D arrays are available. Check out the help pages <code><a href="../reference/rmf_plot.rmf_2d_array.html">?rmf_plot.rmf_2d_array</a></code>, <code><a href="../reference/rmf_plot.rmf_3d_array.html">?rmf_plot.rmf_3d_array</a></code> and <code><a href="../reference/rmf_plot.rmf_4d_array.html">?rmf_plot.rmf_4d_array</a></code> to find out more. Hereâ€™s a basic visualization of a 2D array:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_plot.html">rmf_plot</a></span>(dis$top, <span class="dt">dis =</span> dis)</code></pre></div>
<p><img src="RMODFLOW_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
<p>And here you have a basic map view and two vertical cross-sections for a 4D array:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_plot.html">rmf_plot</a></span>(hed, <span class="dt">dis =</span> dis, <span class="dt">k =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## Warning: Plotting final stress period results.</code></pre>
<p><img src="RMODFLOW_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_plot.html">rmf_plot</a></span>(hed, <span class="dt">dis =</span> dis, <span class="dt">i =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>## Warning: Plotting final stress period results.</code></pre>
<p><img src="RMODFLOW_files/figure-html/unnamed-chunk-11-2.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_plot.html">rmf_plot</a></span>(hed, <span class="dt">dis =</span> dis, <span class="dt">j =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>## Warning: Plotting final stress period results.</code></pre>
<p><img src="RMODFLOW_files/figure-html/unnamed-chunk-11-3.png" width="672"></p>
</div>
<div id="the-pipe-operator" class="section level1">
<h1 class="hasAnchor">
<a href="#the-pipe-operator" class="anchor"></a>The pipe operator</h1>
<p>The <a href="https://cran.r-project.org/web/packages/magrittr/index.html">magrittr</a> pipe is also imported in the package, so at the moment you can do things like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/rmf_example_file.html">rmf_example_file</a></span>(<span class="st">"example-model.dis"</span>) %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/rmf_read_dis.html">rmf_read_dis</a></span>() %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw"><a href="../reference/rmf_plot.html">rmf_plot</a></span>(.$top, <span class="dt">dis =</span> .)</code></pre></div>
<p><img src="RMODFLOW_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
<p>The goal is however to develop a model manipulation language in future which would allow straightforward use of the pipe, as well as several <a href="http://tidyverse.org/">tidyverse</a> tools, so stay tuned!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#example-files">Example files</a></li>
      <li><a href="#io">I/O</a></li>
      <li><a href="#visualization">Visualization</a></li>
      <li><a href="#the-pipe-operator">The pipe operator</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://rogiersbart.github.io/">Bart Rogiers</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
